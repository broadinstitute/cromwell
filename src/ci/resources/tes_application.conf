include required(classpath("application.conf"))
include "build_application.inc.conf"

filesystems {
    blob {
        class = "cromwell.filesystems.blob.BlobPathBuilderFactory"
        global {
            class = "cromwell.filesystems.blob.BlobFileSystemManager"
            config {
                workspace-manager: {
                    url: "https://workspace.dsde-dev.broadinstitute.org"
                    workspace-id: "d4564046-bbba-495c-afec-14f7d3a8283a"
                    container-resource-id: "9e7bdba5-047e-430c-810d-c7cb6645c155"
                    b2cToken: "eyJhbGciOiJSUzI1NiIsImtpZCI6Inp4UnJ6aEw4OTBrYi1vVkZOWkdWUFlxSzYtSkI3RFRlTGVvMllTbzRtc1UiLCJ0eXAiOiJKV1QifQ.eyJlbWFpbCI6InR3aXNlbWFuQGJyb2FkaW5zdGl0dXRlLm9yZyIsImdpdmVuX25hbWUiOiJUaG9tYXMiLCJmYW1pbHlfbmFtZSI6Ildpc2VtYW4iLCJuYW1lIjoiVGhvbWFzIFdpc2VtYW4iLCJpZHAiOiJnb29nbGUuY29tIiwiaWRwX2FjY2Vzc190b2tlbiI6InlhMjkuYTBBZkJfYnlCUHk1MzZwaHZmT2NlQUhjdzdOMG5OVmxSSDVwdkFyOWE2S3ZKbnFPQjQycVZkYzVOUDlJc2Jndk1iakNSZ2YycWRuaUhhMVpZOTlfdThMUTNFWGUzRG80SEhBQkctV2VEVTVmeHZOT1lRNjdNbS16cGRYN2JnOXl5WU5UcTJ3T2lObjNuMmh2bTBOdHBXR2VDOEJJekxZc0hLTzljU3RiS3NWUU5HVGNYa2FDZ1lLQWZZU0FSQVNGUUhzdllsczZoNTVrendUdlBMRTVPd2JMNktueVEwMTgzIiwiZ29vZ2xlX2lkIjoiMTExNDI1MTI3NzgyODk3OTE5MjIxIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FBY0hUdGNhZWxfZTl4dHdJQWdOZW1YY2N4d18xUWtlVjV1cF91NUFRTUMxMU5xNj1zOTYtYyIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJzdWIiOiJhMzYxY2YxNS0xNTgxLTQ2ZDQtYmJkNC1mMGQ0NGFlNjkwODciLCJ0aWQiOiJmZDBiYzBlZi0xNzQ3LTRlZTYtYWIzZS1kNGQ2YmI4ODJkNDAiLCJhenAiOiJiYmQwN2Q0My0wMWNiLTRiNjktOGZkMC01NzQ2ZDlhNWM5ZmUiLCJ2ZXIiOiIxLjAiLCJpYXQiOjE2OTI3Mjc2NjEsImF1ZCI6ImJiZDA3ZDQzLTAxY2ItNGI2OS04ZmQwLTU3NDZkOWE1YzlmZSIsImV4cCI6MTY5MjczMTI2MSwiaXNzIjoiaHR0cHM6Ly90ZXJyYWRldmIyYy5iMmNsb2dpbi5jb20vZmQwYmMwZWYtMTc0Ny00ZWU2LWFiM2UtZDRkNmJiODgyZDQwL3YyLjAvIiwibmJmIjoxNjkyNzI3NjYxfQ.OyIZkNqiGQ_cIih0RYSBbin-BaG7B605MTH7RUIsZQOsLrkD1NR0U5q6tK0BO3A-NqwV4V26suJISGIHF4MlgdFji4p3499p-m7STZ8isQx3644n2jzpvjqaHgVxfYIofEMcDezOo7xZdCViq0UhiC3ajiWTgQmzy-q31L50yqz28ZiwAheTSNbcNyZtVE8ogImpYoem_3qfw-iJu3Sb0u_6OUgsvuiRoYbV-Sh2a4vIeyWlLI8Z6cW5Mrk-xzWSpp7EgnaaxYNye-0PLq5ziQV5DkxZ8XLupnn511wVJrYWkqJ91vEhuXfKLn8ZYnc7iUuJNxoJESRPj0PIit3Ysg"
                }
                container: "sc-d4564046-bbba-495c-afec-14f7d3a8283a"
                endpoint: "https://lz43a8a3d21540dfd25f5ace.blob.core.windows.net"
            }
        }
    }
}

engine {
    filesystems {
        local {
            enabled: true
        }
        http {
            enabled: true
        }
        blob {
            enabled: true
        }
    }
}


backend {
  default = "TES"
  providers {
    TES {
      actor-factory = "cromwell.backend.impl.tes.TesBackendLifecycleActorFactory"
      config {
        # Use for running on blob storage
        root = "https://lz43a8a3d21540dfd25f5ace.blob.core.windows.net/sc-d4564046-bbba-495c-afec-14f7d3a8283a/workspace-services/cbas/terra-app-566e92a0-e55e-4250-b4c1-d0925dd03916-d4564046-bbba-495c-afec-14f7d3a8283a/"
        dockerRoot = "/cromwell-executions"
        endpoint = "https://lzd98e904c9c1cee247af683bc764eb1b22f3912f8e7839afe.servicebus.windows.net/terra-app-566e92a0-e55e-4250-b4c1-d0925dd03916-d4564046-bbba-495c-afec-14f7d3a8283a/tes/v1/tasks"
        concurrent-job-limit = 1000
        workflow-execution-identity = "pet-2676571657071603a9eab"
        bearer-token= "Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6Inp4UnJ6aEw4OTBrYi1vVkZOWkdWUFlxSzYtSkI3RFRlTGVvMllTbzRtc1UiLCJ0eXAiOiJKV1QifQ.eyJlbWFpbCI6InR3aXNlbWFuQGJyb2FkaW5zdGl0dXRlLm9yZyIsImdpdmVuX25hbWUiOiJUaG9tYXMiLCJmYW1pbHlfbmFtZSI6Ildpc2VtYW4iLCJuYW1lIjoiVGhvbWFzIFdpc2VtYW4iLCJpZHAiOiJnb29nbGUuY29tIiwiaWRwX2FjY2Vzc190b2tlbiI6InlhMjkuYTBBZkJfYnlCUHk1MzZwaHZmT2NlQUhjdzdOMG5OVmxSSDVwdkFyOWE2S3ZKbnFPQjQycVZkYzVOUDlJc2Jndk1iakNSZ2YycWRuaUhhMVpZOTlfdThMUTNFWGUzRG80SEhBQkctV2VEVTVmeHZOT1lRNjdNbS16cGRYN2JnOXl5WU5UcTJ3T2lObjNuMmh2bTBOdHBXR2VDOEJJekxZc0hLTzljU3RiS3NWUU5HVGNYa2FDZ1lLQWZZU0FSQVNGUUhzdllsczZoNTVrendUdlBMRTVPd2JMNktueVEwMTgzIiwiZ29vZ2xlX2lkIjoiMTExNDI1MTI3NzgyODk3OTE5MjIxIiwicGljdHVyZSI6Imh0dHBzOi8vbGgzLmdvb2dsZXVzZXJjb250ZW50LmNvbS9hL0FBY0hUdGNhZWxfZTl4dHdJQWdOZW1YY2N4d18xUWtlVjV1cF91NUFRTUMxMU5xNj1zOTYtYyIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJzdWIiOiJhMzYxY2YxNS0xNTgxLTQ2ZDQtYmJkNC1mMGQ0NGFlNjkwODciLCJ0aWQiOiJmZDBiYzBlZi0xNzQ3LTRlZTYtYWIzZS1kNGQ2YmI4ODJkNDAiLCJhenAiOiJiYmQwN2Q0My0wMWNiLTRiNjktOGZkMC01NzQ2ZDlhNWM5ZmUiLCJ2ZXIiOiIxLjAiLCJpYXQiOjE2OTI3Mjc2NjEsImF1ZCI6ImJiZDA3ZDQzLTAxY2ItNGI2OS04ZmQwLTU3NDZkOWE1YzlmZSIsImV4cCI6MTY5MjczMTI2MSwiaXNzIjoiaHR0cHM6Ly90ZXJyYWRldmIyYy5iMmNsb2dpbi5jb20vZmQwYmMwZWYtMTc0Ny00ZWU2LWFiM2UtZDRkNmJiODgyZDQwL3YyLjAvIiwibmJmIjoxNjkyNzI3NjYxfQ.OyIZkNqiGQ_cIih0RYSBbin-BaG7B605MTH7RUIsZQOsLrkD1NR0U5q6tK0BO3A-NqwV4V26suJISGIHF4MlgdFji4p3499p-m7STZ8isQx3644n2jzpvjqaHgVxfYIofEMcDezOo7xZdCViq0UhiC3ajiWTgQmzy-q31L50yqz28ZiwAheTSNbcNyZtVE8ogImpYoem_3qfw-iJu3Sb0u_6OUgsvuiRoYbV-Sh2a4vIeyWlLI8Z6cW5Mrk-xzWSpp7EgnaaxYNye-0PLq5ziQV5DkxZ8XLupnn511wVJrYWkqJ91vEhuXfKLn8ZYnc7iUuJNxoJESRPj0PIit3Ysg"
        # Override default polling to make it faster for speedy tests
        poll-backoff {
          min: "10 seconds"
          max: "5 minutes"
          multiplier: 1.1
          randomization-factor: 0.5
        }

        use_tes_11_preview_backend_parameters = true

        filesystems {
          blob {
            enabled: true
          }
          local {
            enabled: false
          }
          http {
            enabled: true
          }
        }
      }

      # Have the engine (maybe) authenticate to docker.io. See BT-141 for more info.
      include "dockerhub_provider_config_v1.inc.conf"
    }
  }
}

workflow-options {
  # Directory where to write per workflow logs
  workflow-log-dir: "https://lz43a8a3d21540dfd25f5ace.blob.core.windows.net/sc-ebda3e1d-09bf-48b1-be2e-3d09f67dfc5c/workspace-services/cbas/terra-app-4628d0e1-d4b5-4b09-ad5c-9a5766650a7a/workflow-logs"
}